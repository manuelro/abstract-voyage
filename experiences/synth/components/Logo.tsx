import React, { useId } from 'react';

import { SvgStop, Pivot } from '../../../helpers/gradientMath';
import { SvgGradientDef } from '../../../helpers/SvgGradientDef';
import { generateHarmonicGradient } from '../../../helpers/harmonicGradient';
import SvgStaggerGroup from '../../../components/SvgStaggerGroup';

type LogoWithGradientBgProps = {
  /** Gradient stops; defaults to a generated premium gradient. */
  stops?: SvgStop[];

  /**
   * Gradient type for the SVG text fill.
   * - 'linear' (default): <linearGradient>.
   * - 'radial': pivot/anchor-based <radialGradient>.
   */
  gradientType?: 'linear' | 'radial';

  /** Base angle in degrees for linear gradients (0 = left→right across viewBox). */
  angleDeg?: number;

  /**
   * Shared anchor for both gradient types, as % of the SVG box.
   *
   * For radial:
   *  - anchorXPercent → cx (% of width)
   *  - anchorYPercent → cy (% of height)
   *
   * For linear:
   *  - anchorXPercent / anchorYPercent define a point the gradient line passes through.
   *
   * Values:
   *  - 0   → left / top edge
   *  - 50  → center
   *  - 100 → right / bottom edge
   *  - >100 → off-canvas (to the right / below)
   */
  anchorXPercent?: number;
  anchorYPercent?: number;

  /**
   * Pivot for gradient alignment when anchorXPercent / anchorYPercent are not provided.
   * - For linear: used to place the gradient line anchor.
   * - For radial: used to place the gradient center.
   */
  pivot?: Pivot;

  /** Render width (SVG keeps aspect ratio). Pass number (px) or CSS length. */
  width?: number | string;

  /** Extra className to merge with the root SVG class. */
  className?: string;

  /** Accessible label for the logo. */
  ariaLabel?: string;
};

const VIEWBOX_W = 168;
const VIEWBOX_H = 8;

// Default: a premium, darker, center-bright gradient generated around a base hue.
// We use a fixed seed so the gradient is deterministic (avoids SSR/CSR mismatch).
const DEFAULT_STOPS: SvgStop[] = generateHarmonicGradient({
  baseHue: 232,

  hueScheme: 'mono',
  lightnessRange: { min: 65 }, // NOTE: for a closer match to DEFAULT_STOPS, use { min: 70 }
  chromaRange: { min: 80 },
  mode: 'center-bright',
  stops: 22,
  variance: 100,
  centerStretch: 0.9,
  seed: 50,

  // perStopLightness: [100, 100, 100, 100, 100, 100, 100]
  }).map((stop) => ({
  color: stop.color,
  at: stop.at * 100, // convert 0–1 → 0–100 for SvgStop
}));

const LogoWithGradientBg: React.FC<LogoWithGradientBgProps> = ({
  stops = DEFAULT_STOPS,
  gradientType = 'linear',
  angleDeg = 0,
  pivot = 'left-center',
  anchorXPercent,
  anchorYPercent,
  width = VIEWBOX_W,
  className = '',
  ariaLabel = 'Abstract Voyage Logo',
}) => {
  // Namespaced id to avoid collisions, kept internal.
  const gradId = `gradient-logo-grad-${useId()}`;

  return (
    <svg
      role="img"
      aria-label={ariaLabel}
      viewBox={`0 0 ${VIEWBOX_W} ${VIEWBOX_H}`}
      preserveAspectRatio="xMidYMid meet"
      width={width}
      style={{ display: 'block', height: 'auto' }}
      className={[className].join(' ')}
      xmlns="http://www.w3.org/2000/svg"
    >
      <title>{ariaLabel}</title>

      <defs>
        <SvgGradientDef
          id={gradId}
          kind={gradientType}
          width={VIEWBOX_W}
          height={VIEWBOX_H}
          stops={stops}
          angleDeg={angleDeg}
          pivot={pivot}
          anchorXPercent={anchorXPercent}
          anchorYPercent={anchorYPercent}
        />
        {/* Force all logo paths to use this gradient */}
        <style>{`.avText * { fill: url(#${gradId}) !important; }`}</style>
      </defs>

      {/* New logo paths; gradient applied via .avText class */}
      <SvgStaggerGroup
        className="avText"
        initialDelay={0.01}
        stepDelay={0.02}
        duration={1.4}
        direction="reverse"
        scalePivot="left-center"
        bloom
        bloomBase={1}
        bloomPeak={1.4}
        bloomInitialDelay={0.1}
        bloomStepDelay={0.08}
      >
        <path d="M164.323 7.82508V7.13655H167.427V7.82508H164.323ZM164.541 4.38245V3.66114H166.771V4.38245H164.541ZM164.039 0.174805H164.76V7.82508H164.039V0.174805ZM164.432 0.174805H167.317V0.863329H164.432V0.174805Z" fill="white" />
        <path d="M153.651 4.52459V3.83607H155.717V4.52459H153.651ZM154.995 6.04372V3.86885H155.717V6.04372H154.995ZM151.684 6.03279V1.96721H152.405V6.03279H151.684ZM151.684 1.96721C151.684 1.57377 151.768 1.23133 151.935 0.93989C152.103 0.641166 152.339 0.411658 152.645 0.251366C152.951 0.0837886 153.305 0 153.706 0V0.688524C153.298 0.688524 152.977 0.801457 152.744 1.02732C152.518 1.2459 152.405 1.5592 152.405 1.96721H151.684ZM151.684 6.03279H152.405C152.405 6.43352 152.518 6.74681 152.744 6.97268C152.977 7.19854 153.298 7.31148 153.706 7.31148V8C153.305 8 152.951 7.91985 152.645 7.75956C152.339 7.59199 152.103 7.36248 151.935 7.07104C151.768 6.77231 151.684 6.42623 151.684 6.03279ZM155.115 2.20765C155.064 1.73406 154.915 1.36248 154.667 1.0929C154.42 0.823315 154.095 0.688524 153.695 0.688524V0C154.27 0 154.74 0.182149 155.104 0.546448C155.476 0.910747 155.702 1.41712 155.782 2.06557L155.115 2.20765ZM155.717 6.03279C155.717 6.42623 155.633 6.77231 155.465 7.07104C155.298 7.36248 155.061 7.59199 154.755 7.75956C154.456 7.91985 154.103 8 153.695 8V7.31148C154.103 7.31148 154.42 7.19854 154.645 6.97268C154.879 6.74681 154.995 6.43352 154.995 6.03279H155.717Z" fill="white" />
        <path d="M140.276 6.18573V5.49721H143.063V6.18573H140.276ZM141.938 0.174805L140.08 7.82508H139.358L141.216 0.174805H141.938ZM141.959 0.174805L143.817 7.82508H143.096L141.238 0.174805H141.959Z" fill="white" />
        <path d="M129.841 5.22399L131.48 0.174805H132.201L130.562 5.22399H129.841ZM129.841 7.82508V5.22399H130.562V7.82508H129.841ZM129.841 5.22399L128.201 0.174805H128.923L130.562 5.22399H129.841Z" fill="white" />
        <path d="M119.551 6.03284V1.96727H120.273V6.03284H119.551ZM116.229 6.03284V1.96727H116.95V6.03284H116.229ZM120.273 1.9782H119.551C119.551 1.57018 119.435 1.25689 119.202 1.03831C118.976 0.812444 118.659 0.699511 118.251 0.699511V0.0109863C118.659 0.0109863 119.012 0.0947752 119.311 0.262353C119.617 0.422644 119.854 0.652152 120.021 0.950877C120.189 1.24232 120.273 1.58476 120.273 1.9782ZM116.229 1.9782C116.229 1.58476 116.313 1.24232 116.48 0.950877C116.648 0.652152 116.885 0.422644 117.191 0.262353C117.497 0.0947752 117.85 0.0109863 118.251 0.0109863V0.699511C117.843 0.699511 117.522 0.812444 117.289 1.03831C117.063 1.25689 116.95 1.57018 116.95 1.9782H116.229ZM120.273 6.02192C120.273 6.41536 120.189 6.76144 120.021 7.06017C119.854 7.35161 119.617 7.58111 119.311 7.74869C119.012 7.90898 118.659 7.98913 118.251 7.98913V7.3006C118.659 7.3006 118.976 7.18767 119.202 6.96181C119.435 6.73594 119.551 6.42264 119.551 6.02192H120.273ZM116.229 6.02192H116.95C116.95 6.42264 117.063 6.73594 117.289 6.96181C117.522 7.18767 117.843 7.3006 118.251 7.3006V7.98913C117.85 7.98913 117.497 7.90898 117.191 7.74869C116.885 7.58111 116.648 7.35161 116.48 7.06017C116.313 6.76144 116.229 6.41536 116.229 6.02192Z" fill="white" />
        <path d="M105.729 7.82508L107.587 0.174805H108.308L106.45 7.82508H105.729ZM105.707 7.82508L103.849 0.174805H104.57L106.428 7.82508H105.707Z" fill="white" />
        <path d="M95.4314 4.54644C95.2784 4.54644 95.1509 4.49544 95.0489 4.39344C94.9469 4.29144 94.8959 4.16393 94.8959 4.01093C94.8959 3.85792 94.9469 3.73042 95.0489 3.62841C95.1509 3.51912 95.2784 3.46448 95.4314 3.46448C95.5844 3.46448 95.7119 3.51912 95.8139 3.62841C95.9232 3.73042 95.9778 3.85792 95.9778 4.01093C95.9778 4.16393 95.9232 4.29144 95.8139 4.39344C95.7119 4.49544 95.5844 4.54644 95.4314 4.54644Z" fill="white" />
        <path d="M82.8773 0.863329V0.174805H87.1396V0.863329H82.8773ZM84.6478 7.82508V0.174805H85.3691V7.82508H84.6478Z" fill="white" />
        <path d="M71.4507 6.03279V1.96721H72.172V6.03279H71.4507ZM71.4507 1.96721C71.4507 1.57377 71.5345 1.23133 71.7021 0.93989C71.8696 0.641166 72.1064 0.411658 72.4124 0.251366C72.7184 0.0837886 73.0718 0 73.4725 0V0.688524C73.0645 0.688524 72.7439 0.801457 72.5108 1.02732C72.2849 1.2459 72.172 1.5592 72.172 1.96721H71.4507ZM71.4507 6.03279H72.172C72.172 6.43352 72.2849 6.74681 72.5108 6.97268C72.7439 7.19854 73.0645 7.31148 73.4725 7.31148V8C73.0718 8 72.7184 7.91985 72.4124 7.75956C72.1064 7.59199 71.8696 7.36248 71.7021 7.07104C71.5345 6.77231 71.4507 6.42623 71.4507 6.03279ZM74.8824 2.20765C74.8314 1.73406 74.682 1.36248 74.4343 1.0929C74.1866 0.823315 73.8623 0.688524 73.4616 0.688524V0C74.0372 0 74.5071 0.182149 74.8714 0.546448C75.243 0.910747 75.4689 1.41712 75.549 2.06557L74.8824 2.20765ZM74.8824 5.79235L75.549 5.93443C75.4689 6.58288 75.243 7.08925 74.8714 7.45355C74.5071 7.81785 74.0372 8 73.4616 8V7.31148C73.8623 7.31148 74.1866 7.17669 74.4343 6.9071C74.682 6.63752 74.8314 6.26594 74.8824 5.79235Z" fill="white" />
        <path d="M60.0433 6.18573V5.49721H62.8302V6.18573H60.0433ZM61.7045 0.174805L59.8466 7.82508H59.1252L60.9832 0.174805H61.7045ZM61.7263 0.174805L63.5843 7.82508H62.8629L61.005 0.174805H61.7263Z" fill="white" />
        <path d="M50.6041 7.82508L49.1943 4.0218H49.9593L51.3691 7.82508H50.6041ZM48.0467 4.42617V3.73765H49.3582V4.42617H48.0467ZM48.0467 0.863329V0.174805H49.3582V0.863329H48.0467ZM50.6478 2.46989V2.13109H51.3691V2.46989H50.6478ZM51.3691 2.14202H50.6478C50.6478 1.734 50.5312 1.42071 50.2981 1.20213C50.0722 0.976262 49.7553 0.863329 49.3473 0.863329V0.174805C49.7553 0.174805 50.1087 0.258593 50.4074 0.426171C50.7134 0.586462 50.9502 0.815971 51.1178 1.1147C51.2853 1.40613 51.3691 1.74858 51.3691 2.14202ZM51.3691 2.45896C51.3691 2.8524 51.2853 3.19848 51.1178 3.49721C50.9502 3.78865 50.7134 4.01816 50.4074 4.18573C50.1087 4.34602 49.7553 4.42617 49.3473 4.42617V3.73765C49.7553 3.73765 50.0722 3.62471 50.2981 3.39885C50.5312 3.17298 50.6478 2.85969 50.6478 2.45896H51.3691ZM47.7626 7.82508V0.174805H48.4839V7.82508H47.7626Z" fill="white" />
        <path d="M35.6348 0.863329V0.174805H39.8971V0.863329H35.6348ZM37.4053 7.82508V0.174805H38.1266V7.82508H37.4053Z" fill="white" />
        <path d="M27.2934 6.15306C27.2934 5.8762 27.2169 5.62847 27.0639 5.40989C26.9181 5.19131 26.7251 4.98366 26.4846 4.78694C26.2515 4.59022 26.0001 4.3935 25.7305 4.19678C25.461 4.00006 25.2059 3.78876 24.9655 3.5629C24.7324 3.33703 24.5393 3.08567 24.3863 2.8088C24.2406 2.52465 24.1677 2.20406 24.1677 1.84705H24.889C24.889 2.11663 24.9619 2.36436 25.1076 2.59022C25.2606 2.8088 25.4537 3.01645 25.6868 3.21317C25.9273 3.40989 26.1823 3.60661 26.4518 3.80334C26.7214 4.00006 26.9728 4.21135 27.2059 4.43722C27.4464 4.66308 27.6395 4.91445 27.7852 5.19131C27.9382 5.46818 28.0147 5.78876 28.0147 6.15306H27.2934ZM24.1677 1.86891C24.1677 1.47547 24.2515 1.14031 24.4191 0.863446C24.5866 0.586579 24.8234 0.375285 25.1294 0.229565C25.4355 0.083846 25.7888 0.0109863 26.1895 0.0109863V0.699511C25.7815 0.699511 25.461 0.805158 25.2278 1.01645C25.0019 1.22046 24.889 1.50461 24.889 1.86891H24.1677ZM28.0147 6.13121C28.0147 6.52465 27.9309 6.8598 27.7633 7.13667C27.5957 7.41354 27.3589 7.62483 27.0529 7.77055C26.7542 7.91627 26.4008 7.98913 25.9928 7.98913V7.3006C26.4008 7.3006 26.7178 7.1986 26.9436 6.99459C27.1768 6.7833 27.2934 6.4955 27.2934 6.13121H28.0147ZM27.3371 1.68312C27.3007 1.34068 27.1732 1.09295 26.9546 0.939948C26.736 0.779657 26.481 0.699511 26.1895 0.699511V0.0109863C26.5101 0.0109863 26.8016 0.0802032 27.0639 0.218637C27.3334 0.349784 27.552 0.528291 27.7196 0.754156C27.8945 0.980021 28.0001 1.23867 28.0365 1.53011L27.3371 1.68312ZM24.5721 5.78148C24.6231 6.25507 24.7724 6.62665 25.0201 6.89623C25.2679 7.16581 25.5921 7.3006 25.9928 7.3006V7.98913C25.4172 7.98913 24.9436 7.80698 24.5721 7.44268C24.2078 7.07838 23.9855 6.57201 23.9054 5.92356L24.5721 5.78148Z" fill="white" />
        <path d="M13.9101 4.20759V3.48628C14.3181 3.48628 14.6351 3.36606 14.8609 3.12562C15.0941 2.88519 15.2106 2.55368 15.2106 2.13109H15.932C15.932 2.52453 15.8445 2.8779 15.6697 3.1912C15.4948 3.5045 15.2544 3.75222 14.9484 3.93437C14.6423 4.11652 14.2963 4.20759 13.9101 4.20759ZM12.8281 7.82508V7.13655H14.0194V7.82508H12.8281ZM12.8281 4.20759V3.48628H14.0194V4.20759H12.8281ZM15.3199 5.86879V5.58464H16.0412V5.86879H15.3199ZM15.3199 5.59557C15.3199 5.15841 15.2034 4.81961 14.9702 4.57918C14.7443 4.33145 14.4274 4.20759 14.0194 4.20759V3.48628C14.4055 3.48628 14.7516 3.581 15.0576 3.77043C15.3637 3.95258 15.6041 4.20395 15.779 4.52453C15.9538 4.83783 16.0412 5.19484 16.0412 5.59557H15.3199ZM12.8281 0.863329V0.174805H13.9101V0.863329H12.8281ZM15.932 2.14202H15.2106C15.2106 1.734 15.0941 1.42071 14.8609 1.20213C14.6351 0.976262 14.3181 0.863329 13.9101 0.863329V0.174805C14.3181 0.174805 14.6715 0.258593 14.9702 0.426171C15.2762 0.586462 15.513 0.815971 15.6806 1.1147C15.8482 1.40613 15.932 1.74858 15.932 2.14202ZM16.0412 5.85786C16.0412 6.25131 15.9575 6.59739 15.7899 6.89612C15.6223 7.18756 15.3855 7.41706 15.0795 7.58464C14.7808 7.74493 14.4274 7.82508 14.0194 7.82508V7.13655C14.4274 7.13655 14.7443 7.02362 14.9702 6.79775C15.2034 6.57189 15.3199 6.25859 15.3199 5.85786H16.0412ZM12.4347 7.82508V0.174805H13.156V7.82508H12.4347Z" fill="white" />
        <path d="M0.918033 6.18573V5.49721H3.70492V6.18573H0.918033ZM2.57923 0.174805L0.721311 7.82508H0L1.85792 0.174805H2.57923ZM2.60109 0.174805L4.45902 7.82508H3.7377L1.87978 0.174805H2.60109Z" fill="white" />
      </SvgStaggerGroup>
    </svg>
  );
};

export default LogoWithGradientBg;
